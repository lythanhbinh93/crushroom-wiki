<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i ki·ªÉm tra Module 2: S·∫£n ph·∫©m - Crush Room Wiki</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .quiz-header {
            background: linear-gradient(135deg, #e91e63, #f48fb1);
            color: white;
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 32px;
        }
        .quiz-header h1 { margin: 0 0 8px 0; }
        .quiz-header p { margin: 0; opacity: 0.9; }
        
        .quiz-info {
            background: #fce4ec;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 32px;
        }
        .quiz-info ul { margin: 8px 0; padding-left: 24px; }
        
        .section-divider {
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            padding: 16px 24px;
            border-radius: 8px;
            margin: 32px 0;
            font-weight: 600;
            font-size: 18px;
        }
        
        .quiz-question {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .quiz-question-number {
            color: #e91e63;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 12px;
        }
        .quiz-question-text {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            line-height: 1.6;
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .quiz-option {
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .quiz-option:hover {
            border-color: #e91e63;
            background: #fce4ec;
        }
        .quiz-option.selected {
            border-color: #e91e63;
            background: #fce4ec;
        }
        .quiz-option-marker {
            width: 20px;
            height: 20px;
            border: 2px solid #bdbdbd;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .quiz-option.selected .quiz-option-marker {
            border-color: #e91e63;
            background: #e91e63;
            position: relative;
        }
        .quiz-option.selected .quiz-option-marker::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .essay-question {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .essay-answer {
            width: 100%;
            min-height: 150px;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
        }
        .essay-answer:focus {
            outline: none;
            border-color: #e91e63;
        }
        .word-count {
            text-align: right;
            color: #757575;
            font-size: 13px;
            margin-top: 8px;
        }
        
        .submit-button {
            background: #e91e63;
            color: white;
            padding: 16px 48px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: block;
            margin: 32px auto;
        }
        .submit-button:hover {
            background: #c2185b;
            transform: translateY(-2px);
        }
        
        .quiz-result {
            display: none;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            margin-top: 24px;
        }
        .quiz-score {
            font-size: 48px;
            font-weight: 700;
            color: #2e7d32;
            margin: 16px 0;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button & Backdrop -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" style="display:none;">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>
    <div class="mobile-menu-backdrop" id="mobile-menu-backdrop"></div>

    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">üíé</span>
                    <span class="logo-text">Crush Room</span>
                </div>
                <span class="wiki-badge">Wiki</span>
            </div>
            
            <nav class="sidebar-nav">
                <a href="../../index.html" class="nav-item">
                    <span class="nav-icon">üè†</span>
                    <span>Trang ch·ªß</span>
                </a>
                
                <div class="nav-group">
                    <div class="nav-group-header">
                        <span class="nav-icon">üí¨</span>
                        <span>Customer Service</span>
                        <span class="nav-arrow">‚ñº</span>
                    </div>
                    <div class="nav-group-items">
                        <a href="library.html" class="nav-subitem">Th∆∞ vi·ªán h·ªçc t·∫≠p</a>
                        <a href="quiz.html" class="nav-subitem active">B√†i ki·ªÉm tra</a>
                    </div>
                </div>
            </nav>
            
            <div class="user-info"></div>
            
            <div class="sidebar-footer">
                <p>¬© 2025 Crush Room</p>
            </div>
        </aside>

        <main class="main-content">
            <div class="breadcrumb">
                <a href="../../index.html">Trang ch·ªß</a>
                <span>/</span>
                <a href="library.html">CS Training</a>
                <span>/</span>
                <span>B√†i ki·ªÉm tra Module 2</span>
            </div>

            <div class="quiz-header">
                <h1>üíç B√†i ki·ªÉm tra Module 2: Ki·∫øn th·ª©c s·∫£n ph·∫©m</h1>
                <p>Ki·ªÉm tra hi·ªÉu bi·∫øt v·ªÅ COUPLEPIX, Engraved, WarmLove, S·ªï k√Ω ·ª©c v√† kh·∫£ nƒÉng t∆∞ v·∫•n s·∫£n ph·∫©m</p>
            </div>

            <div class="quiz-info">
                <h3>üìã Th√¥ng tin b√†i ki·ªÉm tra</h3>
                <ul>
                    <li><strong>Th·ªùi gian:</strong> 60 ph√∫t</li>
                    <li><strong>S·ªë c√¢u h·ªèi:</strong> 50 c√¢u (40 tr·∫Øc nghi·ªám + 10 t·ª± lu·∫≠n)</li>
                    <li><strong>ƒêi·ªÉm ƒë·∫°t:</strong> ‚â• 7.0/10</li>
                    <li><strong>L∆∞u √Ω:</strong> C·∫ßn n·∫Øm v·ªØng gi√°, ch·∫•t li·ªáu, th·ªùi gian s·∫£n xu·∫•t c·ªßa T·∫§T C·∫¢ s·∫£n ph·∫©m</li>
                </ul>
            </div>

            <!-- Timer Section -->
            <div id="startSection" class="quiz-info" style="text-align: center; background: linear-gradient(135deg, #fff3e0, #ffe0b2);">
                <h3>‚è±Ô∏è Chu·∫©n b·ªã l√†m b√†i</h3>
                <p>Nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu l√†m b√†i. Th·ªùi gian 60 ph√∫t s·∫Ω b·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c.</p>
                <button onclick="startQuiz()" class="submit-button" style="margin: 16px auto;">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</button>
            </div>

            <div id="timerSection" style="display: none; position: sticky; top: 0; z-index: 100; background: linear-gradient(135deg, #e91e63, #f48fb1); color: white; padding: 16px; text-align: center; border-radius: 12px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                <div style="font-size: 14px; margin-bottom: 4px;">‚è±Ô∏è Th·ªùi gian c√≤n l·∫°i</div>
                <div id="timerDisplay" style="font-size: 32px; font-weight: 700;">60:00</div>
                <div id="timerWarning" style="font-size: 13px; margin-top: 4px; display: none;">‚ö†Ô∏è S·∫Øp h·∫øt gi·ªù!</div>
            </div>

           
                <!-- PH·∫¶N B: T·ª∞ LU·∫¨N (10 c√¢u - 2 ƒëi·ªÉm) -->
                <div class="section-divider">
                    PH·∫¶N B: T·ª∞ LU·∫¨N (10 c√¢u - 2 ƒëi·ªÉm)
                </div>

                <!-- Essay 1 - D·∫°ng Li·ªát k√™ -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 1/10 (D·∫°ng: Li·ªát k√™ ki·∫øn th·ª©c)</div>
                    <div class="quiz-question-text">
                        <strong>Y√™u c·∫ßu:</strong> Li·ªát k√™ size ph·ªï th√¥ng c·ªßa d√¢y chuy·ªÅn, v√≤ng tay (c·∫£ 2 ch·∫•t li·ªáu b·∫°c 925 & th√©p). Tr√¨nh b√†y r√µ r√†ng, ƒë·∫ßy ƒë·ªß. (100 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay1" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count1">0</span>/100 t·ª´</div>
                </div>

                <!-- Essay 2 - T∆∞ v·∫•n ch·∫•t li·ªáu -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 2/10 (D·∫°ng: T∆∞ v·∫•n ch·∫•t li·ªáu)</div>
                    <div class="quiz-question-text">
                        <strong>C√¢u h·ªèi c·ªßa kh√°ch:</strong> "Th√©p v√† titan kh√°c nhau nh∆∞ th·∫ø n√†o?"<br>
                        <strong>Y√™u c·∫ßu:</strong> Vi·∫øt c√¢u tr·∫£ l·ªùi gi·∫£i th√≠ch r√µ r√†ng, d·ªÖ hi·ªÉu cho kh√°ch (120 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay2" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count2">0</span>/120 t·ª´</div>
                </div>

                <!-- Essay 3 - T∆∞ v·∫•n b·∫°c -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 3/10 (D·∫°ng: T∆∞ v·∫•n ch·∫•t li·ªáu)</div>
                    <div class="quiz-question-text">
                        <strong>C√¢u h·ªèi c·ªßa kh√°ch:</strong> "B·∫°c c·ªßa shop c√≥ ph·∫£i b·∫°c nguy√™n ch·∫•t kh√¥ng? C√≥ b·ªã ƒëen khi ƒëeo kh√¥ng?"<br>
                        <strong>Y√™u c·∫ßu:</strong> Vi·∫øt c√¢u tr·∫£ l·ªùi gi·∫£i th√≠ch v·ªÅ b·∫°c S925, t·∫°o trust (150 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay3" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count3">0</span>/150 t·ª´</div>
                </div>

                <!-- Essay 4 - T∆∞ v·∫•n s·∫£n ph·∫©m -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 4/10 (D·∫°ng: T∆∞ v·∫•n s·∫£n ph·∫©m)</div>
                    <div class="quiz-question-text">
                        <strong>C√¢u h·ªèi c·ªßa kh√°ch:</strong> "Mini book ch·∫•t li·ªáu th√©p g√¨? Heyes ch·∫•t li·ªáu th√©p g√¨?"<br>
                        <strong>Y√™u c·∫ßu:</strong> Tr·∫£ l·ªùi ch√≠nh x√°c v·ªÅ ch·∫•t li·ªáu t·ª´ng s·∫£n ph·∫©m (80 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay4" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count4">0</span>/80 t·ª´</div>
                </div>

                <!-- Essay 5 - T∆∞ v·∫•n th·ªùi gian -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 5/10 (D·∫°ng: T∆∞ v·∫•n th·ªùi gian)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Kh√°ch h√†ng ·ªü HCM, nh·∫Øn tin v·ªõi shop v√†o ng√†y 3/12, c·∫ßn 1 ƒë√¥i CP08 (v√≤ng chi·∫øu ·∫£nh) & VTW (v√≤ng kh·∫Øc) v√†o ng√†y 17/12.<br>
                        <strong>Y√™u c·∫ßu:</strong> B·∫°n s·∫Ω t∆∞ v·∫•n V·ªÄ TH·ªúI GIAN nh∆∞ th·∫ø n√†o? T√≠nh to√°n c·ª• th·ªÉ (150 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay5" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count5">0</span>/150 t·ª´</div>
                </div>

                <!-- Essay 6 - X·ª≠ l√Ω t√¨nh hu·ªëng -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 6/10 (D·∫°ng: X·ª≠ l√Ω t√¨nh hu·ªëng)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Kh√°ch g·ª≠i tin nh·∫Øn: "M√¨nh ƒëeo v√≤ng tay b·∫°c c·ªßa shop 1 th·ªùi gian th√¨ b·ªã ƒëen l√† sao v·∫≠y shop? M√¨nh mu·ªën tr·∫£ h√†ng"<br>
                        <strong>Y√™u c·∫ßu:</strong> B·∫°n s·∫Ω ph·∫£n h·ªìi nh∆∞ th·∫ø n√†o? X·ª≠ l√Ω c·∫£m x√∫c + gi·∫£i th√≠ch + ƒë∆∞a ra gi·∫£i ph√°p (200 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay6" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count6">0</span>/200 t·ª´</div>
                </div>

                <!-- Essay 7 - X·ª≠ l√Ω t√¨nh hu·ªëng -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 7/10 (D·∫°ng: X·ª≠ l√Ω t√¨nh hu·ªëng)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Kh√°ch ƒë·∫∑t ƒë∆°n h·ªèa t·ªëc nh∆∞ng s·ª£ l·ª´a ƒë·∫£o kh√¥ng mu·ªën chuy·ªÉn kho·∫£n full tr∆∞·ªõc.<br>
                        <strong>Y√™u c·∫ßu:</strong> B·∫°n s·∫Ω x·ª≠ l√Ω nh∆∞ th·∫ø n√†o ƒë·ªÉ v·ª´a t·∫°o trust v·ª´a ƒë·∫£m b·∫£o quy tr√¨nh? (180 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay7" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count7">0</span>/180 t·ª´</div>
                </div>

                <!-- Essay 8 - X·ª≠ l√Ω t√¨nh hu·ªëng -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 8/10 (D·∫°ng: X·ª≠ l√Ω t√¨nh hu·ªëng)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Ban ƒë·∫ßu kh√°ch d·ª± ƒë·ªãnh ƒë·∫∑t 1 v√≤ng tay Heyes d√¢y Cuban, nh∆∞ng l√∫c sau l·∫°i mu·ªën thay b·∫±ng d√¢y Snake Chain.<br>
                        <strong>Y√™u c·∫ßu:</strong> B·∫°n s·∫Ω ph·∫£n h·ªìi nh∆∞ th·∫ø n√†o? X·ª≠ l√Ω linh ho·∫°t (120 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay8" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count8">0</span>/120 t·ª´</div>
                </div>

                <!-- Essay 9 - T∆∞ v·∫•n t·ªïng h·ª£p -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 9/10 (D·∫°ng: T∆∞ v·∫•n t·ªïng h·ª£p)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Kh√°ch h·ªèi: "Em mu·ªën t·∫∑ng b·∫°n g√°i v√≤ng c√≥ ·∫£nh, nh∆∞ng s·ª£ ·∫£nh kh√¥ng r√µ. Shop t∆∞ v·∫•n em n√™n ch·ªçn s·∫£n ph·∫©m n√†o?"<br>
                        <strong>Y√™u c·∫ßu:</strong> T∆∞ v·∫•n s·∫£n ph·∫©m ph√π h·ª£p + gi·∫£i th√≠ch v·ªÅ ƒë·ªô n√©t + t·∫°o trust (180 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay9" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count9">0</span>/180 t·ª´</div>
                </div>

                <!-- Essay 10 - T∆∞ v·∫•n ph·ª©c t·∫°p -->
                <div class="essay-question">
                    <div class="quiz-question-number">C√¢u 10/10 (D·∫°ng: T∆∞ v·∫•n ph·ª©c t·∫°p)</div>
                    <div class="quiz-question-text">
                        <strong>T√¨nh hu·ªëng:</strong> Kh√°ch h·ªèi: "Em mu·ªën mua qu√† cho b·∫°n g√°i, budget t·∫ßm 500-700k, c·∫ßn trong 10 ng√†y, c√≥ ·∫£nh 2 ƒë·ª©a. Nh∆∞ng em th·∫•y b·∫°n g√°i hay b·ªã d·ªã ·ª©ng kim lo·∫°i. Shop t∆∞ v·∫•n gi√∫p em?"<br>
                        <strong>Y√™u c·∫ßu:</strong> T∆∞ v·∫•n to√†n di·ªán (s·∫£n ph·∫©m, ch·∫•t li·ªáu, th·ªùi gian, gi·∫£i ph√°p d·ªã ·ª©ng) (250 t·ª´)
                    </div>
                    <textarea class="essay-answer" id="essay10" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
                    <div class="word-count"><span id="count10">0</span>/250 t·ª´</div>
                </div>

                <button type="submit" class="submit-button">N·ªòP B√ÄI</button>
            </form>

            <!-- Result Section -->
            <div class="quiz-result" id="result">
                <h2>üéâ K·∫øt qu·∫£ b√†i ki·ªÉm tra</h2>
                <div class="quiz-score" id="score">0/10</div>
                <div style="font-size: 18px; color: #424242; margin: 16px 0;">
                    <div id="percentage"></div>
                    <div id="resultMessage" style="margin-top: 12px; font-weight: 500;"></div>
                </div>

                <!-- Chi ti·∫øt k·∫øt qu·∫£ -->
                <div style="background: white; border-radius: 12px; padding: 24px; margin: 24px 0; text-align: left;">
                    <h3 style="margin-top: 0; color: #e91e63;">üìä Chi ti·∫øt b√†i l√†m</h3>
                    
                    <div style="margin-bottom: 16px;">
                        <strong>Th√¥ng tin h·ªçc vi√™n:</strong><br>
                        <div style="margin-top: 8px;">
                            H·ªç t√™n: <input type="text" id="studentName" placeholder="Nh·∫≠p h·ªç t√™n" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; width: 250px; margin-left: 8px;">
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
                        <div style="background: #f5f5f5; padding: 16px; border-radius: 8px;">
                            <div style="color: #757575; font-size: 14px;">Ph·∫ßn tr·∫Øc nghi·ªám</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2196f3;" id="mcScore">0/40</div>
                        </div>
                        <div style="background: #f5f5f5; padding: 16px; border-radius: 8px;">
                            <div style="color: #757575; font-size: 14px;">Ph·∫ßn t·ª± lu·∫≠n</div>
                            <div style="font-size: 24px; font-weight: 700; color: #ff9800;">Ch∆∞a ch·∫•m</div>
                        </div>
                    </div>

                    <div style="margin-top: 16px; padding: 16px; background: #fff3e0; border-radius: 8px;">
                        <strong>‚è±Ô∏è Th·ªùi gian l√†m b√†i:</strong> <span id="timeTaken"></span>
                    </div>

                    <div style="margin-top: 16px; padding: 16px; background: #e3f2fd; border-radius: 8px;">
                        <strong>üìù Ghi ch√∫ cho leader:</strong><br>
                        <textarea id="leaderNote" placeholder="Ghi ch√∫ v·ªÅ b√†i l√†m c·ªßa h·ªçc vi√™n (t·ª± lu·∫≠n c·∫ßn ch·∫•m th·ªß c√¥ng)..." style="width: 100%; min-height: 80px; margin-top: 8px; padding: 12px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: 'Inter', sans-serif;"></textarea>
                    </div>
                </div>

                <button onclick="savePDF()" class="submit-button" style="background: #4caf50;">
                    üñ®Ô∏è IN K·∫æT QU·∫¢ (PDF)
                </button>
                <p style="font-size: 13px; color: #757575; margin-top: 12px;">Nh·∫•n n√∫t ƒë·ªÉ in ra PDF. Sau khi in, ch·ªçn "Save as PDF" trong h·ªôp tho·∫°i in.</p>
            </div>
        </main>
    </div>

    <script src="../../js/auth.js"></script>
    <script src="../../js/main.js"></script>
    <script>
        // ƒê√°p √°n ƒë√∫ng cho 40 c√¢u tr·∫Øc nghi·ªám
        const correctAnswers = {
            1: 'B', 2: 'B', 3: 'B', 4: 'B', 5: 'B',
            6: 'B', 7: 'B', 8: 'A', 9: 'B', 10: 'B',
            11: 'B', 12: 'B', 13: 'B', 14: 'B', 15: 'B',
            16: 'B', 17: 'A', 18: 'B', 19: 'B', 20: 'B',
            21: 'B', 22: 'C', 23: 'B', 24: 'C', 25: 'C',
            26: 'B', 27: 'B', 28: 'C', 29: 'B', 30: 'C',
            31: 'C', 32: 'B', 33: 'B', 34: 'B', 35: 'B',
            36: 'B', 37: 'B', 38: 'B', 39: 'C', 40: 'B'
        };

        const userAnswers = {};
        let timerInterval;
        let timeRemaining = 3600; // 60 ph√∫t = 3600 gi√¢y
        let startTime;

        // B·∫Øt ƒë·∫ßu l√†m b√†i
        function startQuiz() {
            document.getElementById('startSection').style.display = 'none';
            document.getElementById('timerSection').style.display = 'block';
            document.getElementById('quizForm').style.display = 'block';
            
            startTime = new Date();
            startTimer();
        }

        // Timer ƒë·∫øm ng∆∞·ª£c
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // C·∫£nh b√°o khi c√≤n 5 ph√∫t
                if (timeRemaining === 300) {
                    document.getElementById('timerWarning').style.display = 'block';
                    document.getElementById('timerSection').style.background = 
                        'linear-gradient(135deg, #ff5722, #ff8a65)';
                }
                
                // H·∫øt gi·ªù
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    alert('‚è∞ H·∫øt gi·ªù! B√†i ki·ªÉm tra s·∫Ω t·ª± ƒë·ªông n·ªôp.');
                    document.getElementById('quizForm').dispatchEvent(new Event('submit'));
                }
            }, 1000);
        }

        function selectOption(questionNum, answer) {
            const question = document.querySelectorAll('.quiz-question')[questionNum - 1];
            if (question) {
                const options = question.querySelectorAll('.quiz-option');
                options.forEach(opt => opt.classList.remove('selected'));
                event.currentTarget.classList.add('selected');
                userAnswers[questionNum] = answer;
            }
        }

        // Word counter cho essay
        for (let i = 1; i <= 10; i++) {
            const textarea = document.getElementById('essay' + i);
            const counter = document.getElementById('count' + i);
            
            if (textarea && counter) {
                textarea.addEventListener('input', function() {
                    const words = this.value.trim().split(/\s+/).filter(word => word.length > 0);
                    counter.textContent = words.length;
                });
            }
        }

        // Submit form
        document.getElementById('quizForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // D·ª´ng timer
            clearInterval(timerInterval);
            
            // T√≠nh ƒëi·ªÉm tr·∫Øc nghi·ªám
            let correctCount = 0;
            for (let i = 1; i <= 40; i++) {
                if (userAnswers[i] === correctAnswers[i]) {
                    correctCount++;
                }
            }
            
            const mcScore = correctCount * 0.2;
            const percentage = (correctCount / 40) * 100;
            
            // T√≠nh th·ªùi gian l√†m b√†i
            const endTime = new Date();
            const timeDiff = Math.floor((endTime - startTime) / 1000);
            const minutesTaken = Math.floor(timeDiff / 60);
            const secondsTaken = timeDiff % 60;
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            document.getElementById('result').style.display = 'block';
            document.getElementById('score').textContent = mcScore.toFixed(1) + '/8.0';
            document.getElementById('mcScore').textContent = correctCount + '/40 ƒë√∫ng (' + percentage.toFixed(1) + '%)';
            document.getElementById('percentage').innerHTML = 
                '<strong>Ph·∫ßn tr·∫Øc nghi·ªám:</strong> ' + mcScore.toFixed(1) + '/8 ƒëi·ªÉm';
            document.getElementById('timeTaken').textContent = 
                minutesTaken + ' ph√∫t ' + secondsTaken + ' gi√¢y';
            
            const resultMsg = document.getElementById('resultMessage');
            if (mcScore >= 7.2) {
                resultMsg.innerHTML = 'üåü <strong>Xu·∫•t s·∫Øc!</strong> Ph·∫ßn tr·∫Øc nghi·ªám r·∫•t t·ªët.';
            } else if (mcScore >= 6.4) {
                resultMsg.innerHTML = 'üëè <strong>Kh√°!</strong> C·∫ßn c·ªë g·∫Øng th√™m ·ªü ph·∫ßn t·ª± lu·∫≠n.';
            } else if (mcScore >= 5.6) {
                resultMsg.innerHTML = '‚úÖ <strong>Trung b√¨nh.</strong> √în l·∫°i ki·∫øn th·ª©c s·∫£n ph·∫©m.';
            } else {
                resultMsg.innerHTML = 'üìö <strong>Ch∆∞a ƒë·∫°t.</strong> C·∫ßn h·ªçc l·∫°i Module 2.';
            }
            
            // Scroll to result
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
            
            // ·∫®n timer
            document.getElementById('timerSection').style.display = 'none';
        });

        // Save PDF function - In tr·ª±c ti·∫øp HTML
        function savePDF() {
            const studentName = document.getElementById('studentName').value.trim();
            if (!studentName) {
                alert('Vui l√≤ng nh·∫≠p h·ªç t√™n h·ªçc vi√™n!');
                return;
            }

            // T·∫°o c·ª≠a s·ªï m·ªõi ƒë·ªÉ in
            const printWindow = window.open('', '_blank');
            
            // T·∫°o n·ªôi dung HTML ƒë·ªÉ in
            let htmlContent = `
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>K·∫øt qu·∫£ - ${studentName} - Module 2</title>
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }
        body {
            font-family: Arial, sans-serif;
            line-height: 1.5;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #e91e63;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        .header h1 {
            color: #e91e63;
            margin: 0 0 5px 0;
            font-size: 28px;
        }
        .header h2 {
            color: #424242;
            margin: 5px 0;
            font-size: 18px;
            font-weight: normal;
        }
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        .info-table td:first-child {
            background: #f5f5f5;
            font-weight: bold;
            width: 30%;
        }
        .warning-box {
            background: #fff3e0;
            padding: 12px;
            border-left: 4px solid #ff9800;
            margin: 15px 0;
            page-break-inside: avoid;
        }
        .section-title {
            color: #e91e63;
            font-size: 18px;
            margin-top: 25px;
            margin-bottom: 15px;
            border-bottom: 2px solid #f48fb1;
            padding-bottom: 5px;
            page-break-after: avoid;
        }
        .mc-answers {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        .mc-item {
            padding: 6px;
            border: 1px solid #ddd;
            text-align: center;
            font-size: 13px;
        }
        .mc-item.correct {
            background: #c8e6c9;
            border-color: #4caf50;
            font-weight: bold;
        }
        .mc-item.wrong {
            background: #ffcdd2;
            border-color: #f44336;
        }
        .mc-item.unanswered {
            background: #f5f5f5;
            color: #999;
        }
        .essay-item {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        .essay-question {
            background: #f5f5f5;
            padding: 10px;
            border-left: 4px solid #e91e63;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .essay-answer {
            padding: 12px;
            border: 1px solid #ddd;
            background: white;
            min-height: 60px;
            white-space: pre-wrap;
        }
        .essay-meta {
            margin-top: 5px;
            font-size: 13px;
            color: #666;
        }
        .scoring-box {
            margin-top: 8px;
            padding: 8px;
            background: #f9f9f9;
            border: 1px dashed #ccc;
        }
        .footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #666;
            font-size: 13px;
            page-break-inside: avoid;
        }
        .legend {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 13px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-box {
            width: 16px;
            height: 16px;
            border: 1px solid #999;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button & Backdrop -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" style="display:none;">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>
    <div class="mobile-menu-backdrop" id="mobile-menu-backdrop"></div>

    <div class="header">
        <h1>üíé CRUSH ROOM</h1>
        <h2>K·∫øt qu·∫£ b√†i ki·ªÉm tra Module 2: S·∫£n ph·∫©m</h2>
    </div>

    <table class="info-table">
        <tr>
            <td>H·ªç t√™n:</td>
            <td><strong>${studentName}</strong></td>
        </tr>
        <tr>
            <td>Ng√†y thi:</td>
            <td>${new Date().toLocaleString('vi-VN')}</td>
        </tr>
        <tr>
            <td>Th·ªùi gian l√†m b√†i:</td>
            <td>${document.getElementById('timeTaken').textContent}</td>
        </tr>
        <tr>
            <td>ƒêi·ªÉm tr·∫Øc nghi·ªám:</td>
            <td><strong style="color: #2196f3; font-size: 16px;">${document.getElementById('mcScore').textContent}</strong></td>
        </tr>
    </table>

    <div class="warning-box">
        <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> Ph·∫ßn t·ª± lu·∫≠n c·∫ßn leader ch·∫•m th·ªß c√¥ng theo rubric (0.2ƒë/c√¢u). T·ªïng ƒëi·ªÉm = ƒêi·ªÉm tr·∫Øc nghi·ªám + ƒêi·ªÉm t·ª± lu·∫≠n (t·ªëi ƒëa 10 ƒëi·ªÉm).
    </div>

    <h3 class="section-title">üìä ƒê√°p √°n tr·∫Øc nghi·ªám (40 c√¢u)</h3>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-box" style="background: #c8e6c9; border-color: #4caf50;"></div>
            <span>ƒê√∫ng</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: #ffcdd2; border-color: #f44336;"></div>
            <span>Sai</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: #f5f5f5;"></div>
            <span>Ch∆∞a tr·∫£ l·ªùi</span>
        </div>
    </div>

    <div class="mc-answers">
`;

            // Th√™m 40 c√¢u tr·∫Øc nghi·ªám
            for (let i = 1; i <= 40; i++) {
                const userAnswer = userAnswers[i] || '';
                const correctAnswer = correctAnswers[i];
                let className = 'unanswered';
                let displayText = `${i}. -`;
                
                if (userAnswer) {
                    if (userAnswer === correctAnswer) {
                        className = 'correct';
                        displayText = `${i}. ${userAnswer} ‚úì`;
                    } else {
                        className = 'wrong';
                        displayText = `${i}. ${userAnswer} (ƒê: ${correctAnswer})`;
                    }
                }
                
                htmlContent += `<div class="mc-item ${className}">${displayText}</div>\n`;
            }

            htmlContent += `
    </div>

    <h3 class="section-title">üìù C√¢u tr·∫£ l·ªùi t·ª± lu·∫≠n</h3>
`;

            // Th√™m 10 c√¢u t·ª± lu·∫≠n
            for (let i = 1; i <= 10; i++) {
                const essayAnswer = document.getElementById('essay' + i).value.trim();
                const essayQuestion = document.querySelectorAll('.essay-question')[i - 1];
                const questionText = essayQuestion.querySelector('.quiz-question-text').innerText;
                const wordCount = essayAnswer ? essayAnswer.split(/\s+/).filter(w => w.length > 0).length : 0;
                
                htmlContent += `
    <div class="essay-item">
        <div class="essay-question">C√¢u ${i}/10: ${questionText.replace(/\n/g, '<br>')}</div>
        <div class="essay-answer">${essayAnswer || '<em style="color: #999;">Ch∆∞a tr·∫£ l·ªùi</em>'}</div>
        <div class="essay-meta">S·ªë t·ª´: ${wordCount}</div>
        <div class="scoring-box">
            <strong>ƒêi·ªÉm:</strong> _____/0.2ƒë &nbsp;&nbsp;&nbsp; <strong>Nh·∫≠n x√©t:</strong> ___________________________________________
        </div>
    </div>
`;
            }

            // Th√™m ghi ch√∫ n·∫øu c√≥
            const leaderNote = document.getElementById('leaderNote').value.trim();
            if (leaderNote) {
                htmlContent += `
    <div style="margin-top: 25px; padding: 12px; background: #e3f2fd; border-left: 4px solid #2196f3; page-break-inside: avoid;">
        <strong>üìå Ghi ch√∫ t·ª´ h·ªçc vi√™n:</strong><br>
        <div style="margin-top: 8px;">${leaderNote}</div>
    </div>
`;
            }

            // Footer
            htmlContent += `
    <div class="footer">
        <p><strong>T·ªïng ƒëi·ªÉm = ƒêi·ªÉm tr·∫Øc nghi·ªám + ƒêi·ªÉm t·ª± lu·∫≠n (c·∫ßn ch·∫•m)</strong></p>
        <p>ƒêi·ªÉm ƒë·∫°t: ‚â• 7.0/10</p>
        <p style="margin-top: 10px;">Crush Room CS Training - Module 2</p>
    </div>
</body>
</html>
`;

            // Ghi n·ªôi dung v√†o c·ª≠a s·ªï m·ªõi v√† in
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            // ƒê·ª£i load xong r·ªìi m·ªõi in
            printWindow.onload = function() {
                printWindow.print();
            };
        }

        // Auth check
        if (!Auth.requireAuth()) { /* redirect */ }
        else if (!Auth.requirePermission('cs')) { /* show denied */ }
        else { Auth.renderAuthUI(); }
    </script>
</body>
</html>
