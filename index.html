<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crush Room Wiki</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Mobile Menu Button & Backdrop -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" style="display:none;">
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>
    <div class="mobile-menu-backdrop" id="mobile-menu-backdrop"></div>

    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">üíé</span>
                    <span class="logo-text">Crush Room</span>
                </div>
                <span class="wiki-badge">Wiki</span>
            </div>
            
            <nav class="sidebar-nav">
                <a href="index.html" class="nav-item active">
                    <span class="nav-icon">üè†</span>
                    <span>Trang ch·ªß</span>
                </a>
                
                <a href="admin.html" class="nav-item" data-admin-only>
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Admin</span>
                </a>

                <a href="pages/schedule-admin.html" class="nav-item" data-admin-only>
                    <span class="nav-icon">üß©</span>
                    <span>Qu·∫£n l√Ω l·ªãch l√†m</span>
                </a>

                <!-- Menu ƒëƒÉng k√Ω l·ªãch l√†m: s·∫Ω b·ªã ·∫©n b·∫±ng JS cho fulltime kh√¥ng thu·ªôc team CS -->
                <a href="pages/schedule.html" class="nav-item" data-schedule-link>
                    <span class="nav-icon">üìÖ</span>
                    <span>ƒêƒÉng k√Ω l·ªãch l√†m</span>
                </a>
                
                <div class="nav-group" data-module-group="cs">
                    <div class="nav-group-header">
                        <span class="nav-icon">üí¨</span>
                        <span>Customer Service</span>
                        <span class="nav-arrow">‚ñº</span>
                    </div>
                    <div class="nav-group-items">
                        <a href="pages/cs/library.html" class="nav-subitem" data-module="cs">Th∆∞ vi·ªán h·ªçc t·∫≠p</a>
                        <a href="pages/cs/quiz.html" class="nav-subitem" data-module="cs">B√†i ki·ªÉm tra</a>
                    </div>
                </div>
                
                <div class="nav-group" data-module-group="marketing">
                    <div class="nav-group-header">
                        <span class="nav-icon">üì¢</span>
                        <span>Marketing</span>
                        <span class="nav-arrow">‚ñº</span>
                    </div>
                    <div class="nav-group-items">
                        <a href="pages/marketing/library.html" class="nav-subitem" data-module="marketing">Th∆∞ vi·ªán h·ªçc t·∫≠p</a>
                        <a href="pages/marketing/quiz.html" class="nav-subitem" data-module="marketing">B√†i ki·ªÉm tra</a>
                    </div>
                </div>
                
                <div class="nav-group" data-module-group="laser">
                    <div class="nav-group-header">
                        <span class="nav-icon">‚ö°</span>
                        <span>Laser</span>
                        <span class="nav-arrow">‚ñº</span>
                    </div>
                    <div class="nav-group-items">
                        <a href="pages/laser/guide.html" class="nav-subitem" data-module="laser">H∆∞·ªõng d·∫´n kh·∫Øc Laser</a>
                        <a href="pages/laser/lightburn.html" class="nav-subitem" data-module="laser">Th√¥ng s·ªë Lightburn</a>
                    </div>
                </div>
            </nav>
            
            <!-- User Info -->
            <div class="user-info"></div>
            
            <div class="sidebar-footer">
                <p>¬© 2025 Crush Room</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="page-header">
                <h1>Ch√†o m·ª´ng ƒë·∫øn Crush Room Wiki</h1>
                <p class="header-subtitle">Trung t√¢m t√†i li·ªáu & ƒë√†o t·∫°o n·ªôi b·ªô</p>
            </header>

            <section class="quick-access">
                <h2 class="section-title">Truy c·∫≠p nhanh</h2>
                <div class="card-grid">
                    <!-- ƒêƒÉng k√Ω l·ªãch l√†m (s·∫Ω ·∫©n v·ªõi fulltime MO b·∫±ng JS) -->
                    <a href="pages/schedule.html" class="card card-schedule" data-schedule-card>
                        <div class="card-icon">üìÖ</div>
                        <h3 class="card-title">ƒêƒÉng k√Ω l·ªãch l√†m</h3>
                        <p class="card-desc">ƒêƒÉng k√Ω ca l√†m vi·ªác h√†ng tu·∫ßn</p>
                    </a>

                    <!-- CS -->
                    <div class="card card-cs">
                        <div class="card-icon">üí¨</div>
                        <h3 class="card-title">Customer Service</h3>
                        <p class="card-desc">T√†i li·ªáu & b√†i test cho team CS</p>
                        <div class="card-links">
                            <a href="pages/cs/library.html">üìö Th∆∞ vi·ªán</a>
                            <a href="pages/cs/quiz.html">‚úèÔ∏è B√†i ki·ªÉm tra</a>
                        </div>
                    </div>

                    <!-- Marketing -->
                    <div class="card card-marketing">
                        <div class="card-icon">üì¢</div>
                        <h3 class="card-title">Marketing</h3>
                        <p class="card-desc">T√†i li·ªáu & b√†i test cho team Marketing</p>
                        <div class="card-links">
                            <a href="pages/marketing/library.html">üìö Th∆∞ vi·ªán</a>
                            <a href="pages/marketing/quiz.html">‚úèÔ∏è B√†i ki·ªÉm tra</a>
                        </div>
                    </div>

                    <!-- Laser -->
                    <div class="card card-laser">
                        <div class="card-icon">‚ö°</div>
                        <h3 class="card-title">Laser</h3>
                        <p class="card-desc">H∆∞·ªõng d·∫´n kh·∫Øc & th√¥ng s·ªë m√°y</p>
                        <div class="card-links">
                            <a href="pages/laser/guide.html">üìñ H∆∞·ªõng d·∫´n</a>
                            <a href="pages/laser/lightburn.html">‚öôÔ∏è Lightburn</a>
                        </div>
                    </div>
                </div>
            </section>

            <section class="announcements">
                <h2 class="section-title">üìå Th√¥ng b√°o m·ªõi</h2>
                <div class="announcement-list">
                    <div class="announcement-item">
                        <span class="announcement-date">28/11/2025</span>
                        <span class="announcement-text">C·∫≠p nh·∫≠t th√¥ng s·ªë Lightburn cho v·∫≠t li·ªáu m·ªõi</span>
                    </div>
                    <div class="announcement-item">
                        <span class="announcement-date">25/11/2025</span>
                        <span class="announcement-text">Th√™m b√†i ki·ªÉm tra CS c·∫•p ƒë·ªô 2</span>
                    </div>
                    <div class="announcement-item">
                        <span class="announcement-date">20/11/2025</span>
                        <span class="announcement-text">Ra m·∫Øt Wiki n·ªôi b·ªô Crush Room</span>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Require authentication
            if (!Auth.requireAuth()) {
                return; // s·∫Ω t·ª± redirect trong Auth
            }

            // Render auth UI (user info, ·∫©n nh√≥m module kh√¥ng c√≥ quy·ªÅn, v.v.)
            Auth.renderAuthUI();

            const currentUser = Auth.getCurrentUser();
            if (!currentUser) return;

            const employmentType = (currentUser.employmentType || 'parttime').toLowerCase();
            const permissions   = currentUser.permissions || {};
            const isCS          = !!permissions.cs;
            const isPartTime    = employmentType !== 'fulltime';

            // Rule:
            // - Part-time (m·ªçi team): xem & ƒëƒÉng k√Ω b√¨nh th∆∞·ªùng
            // - Fulltime team CS: v·∫´n xem & ƒëƒÉng k√Ω l·ªãch l√†m
            // - Fulltime kh√¥ng thu·ªôc CS (MO): ·∫©n menu + th·∫ª ƒëƒÉng k√Ω l·ªãch l√†m
            const canUseSchedule =
                isPartTime ||
                (employmentType === 'fulltime' && isCS);

            if (!canUseSchedule) {
                // ·∫®n menu sidebar
                const scheduleNav = document.querySelector('a.nav-item[data-schedule-link]');
                if (scheduleNav) {
                    scheduleNav.style.display = 'none';
                }

                // ·∫®n card truy c·∫≠p nhanh
                const scheduleCard = document.querySelector('.card-schedule[data-schedule-card]');
                if (scheduleCard) {
                    scheduleCard.style.display = 'none';
                }
            }
        });
    </script>
</body>
</html>
